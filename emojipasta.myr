use std
use "misc"
use "radix/radix"

pkg fltr =
	const emojipasta : (line : byte[:] -> byte[:])
;;

var etree

/* this needs work... */
const emap = [
	/* hit or miss */
	("hit", "ğŸ‘Š"),
	("miss", "ğŸ˜³"),
	("guess", "ğŸ¤”"),
	("never", "âŒ"),
	("huh", "ğŸ˜•"),
	("boyfriend", "ğŸ’‘"),
	("kiss", "ğŸ˜˜ğŸ’‹"),
	("find", "ğŸ”"),
	("girl", "ğŸ’ƒ"),
	("dab", "ğŸ˜"),

	/* i'm deleting you daddy*/
	("delet", "ğŸ™…"),
	("error", "ğŸš«"),
	("true", "ğŸ’¯"),
	("dadd", "ğŸ’–"),
	("daddy", "ğŸ‘…"),
	("daddy's", "ğŸ‘¨â€ğŸ‘§"),
	("cum", "ğŸ’¦"),
	("cummie", "ğŸ’¦ğŸ’¦"),
	("squishy", "â˜ï¸ğŸ’¦"),
	("kitten", "ğŸ˜»"),

	/* navy seals */
	("fuck", "ğŸ‘ğŸ†"),
	("fucking", "ğŸ˜ˆ"),
	("bitch", "ğŸ€"),
	("gorilla", "ğŸ¦"),
	("guerrilla", "ğŸ¦"),
	("war", "ğŸ”«"),
	("target", "ğŸ¯"),
	("navy", "âš“ï¸"),
	("graduated", "ğŸ‘¨â€ğŸ“"),
	("earth", "ğŸŒ"),
	("spy", "ğŸ•µï¸â€â™€ï¸"),
	("spies", "ğŸ•µï¸â€â™‚ï¸"),
	("usa", "ğŸ‡ºğŸ‡¸ğŸ‡ºğŸ‡¸"),
	("storm", "ğŸŒ©"),
	("bare", "ğŸ»"),
	("combat", "âš”ï¸"),
	("dead", "âš°ï¸"),

	("win", "ğŸ†"),
	("pill", "ğŸ’Š"),
	("cash", "ğŸ’µğŸ’µ"),
	("money", "ğŸ¤‘"),
	("sale", "ğŸ’¸"),
	("price", "ğŸ·"),
	("tag", "ğŸ·"),
	("stop", "â›”ï¸ğŸš·"),
	("lewd", "ğŸ”"),
	("alarm", "â°"),
	("clock", "ğŸ•°"),
	("time", "â³"),
	("alert", "ğŸš¨"),
	("warning", "â˜¢ï¸"),
	("warn", "âš ï¸"),
	("danger", "â˜£ï¸"),
	("pray", "ğŸ™"),
	("bridge", "ğŸŒ‰"),
	("bf", "ğŸ‘«"),
	("gf", "ğŸ’‘"),
	("girlfriend", "ğŸ‘«"),

	("lmao", "ğŸ˜‚"),
	("fam", "ğŸ˜‚"),
	("good", "ğŸ˜œ"),
	("mad", "ğŸ˜¡"),
	("made", ""),
	("angry", "ğŸ¤¬"),
	("think", "ğŸ¤”"),
	("tired", "ğŸ˜ª"),
	("gross", "ğŸ¤®"),
	("sick", "ğŸ˜·"),
	("clown", "ğŸ¤¡"),
	("poo", "ğŸ’©"),
	("shit", "ğŸ’©"),
	("ok", "ğŸ‘ŒğŸ‘Œ"),
	("cop", "ğŸ‘®â€â™‚ï¸"),
	("doc", "ğŸ‘©â€âš•ï¸"),
	("thots", "ğŸ‘¯â€â™€ï¸"),
	("dress", "ğŸ‘—"),
	("ring", "ğŸ’"),
	("dog", "ğŸ¶"),
	("cat", "ğŸ±"),
	("mouse", "ğŸ­"),
	("hamster", "ğŸ¹"),
	("bunn", "ğŸ°"),
	("fox", "ğŸ¦Š"),
	("bear", "ğŸ»"),
	("moo", "ğŸ®"),
	("pig", "ğŸ·"),
	("frog", "ğŸ¸"),
	("meme", "ğŸ¸"),
	("monk", "ğŸµ"),
	("chicken", "ğŸ”"),
	("chick", "ğŸ¥"),
	("duck", "ğŸ¦†"),
	("bat", "ğŸ¦‡"),
	("wolf", "ğŸº"),
	("bor", "ğŸ—"),
	("boar", "ğŸ—"),
	("pony", "ğŸ´"),
	("bee", "ğŸ"),
	("been", ""),
	("snail", "ğŸŒ"),
	("ant", "ğŸœ"),
	("bug", "ğŸ¦Ÿ"),
	("web", "ğŸ•¸"),
	("snake", "ğŸ"),
	("lizard", "ğŸ¦"),
	("dino", "ğŸ¦–"),
	("octo", "ğŸ™"),
	("squid", "ğŸ¦‘"),
	("crab", "ğŸ¦€"),
	("puff", "ğŸ¡"),
	("fish", "ğŸ "),
	("dolph", "ğŸ¬"),
	("whale", "ğŸ³"),
	("shark", "ğŸ¦ˆ"),
	("croc", "ğŸŠ"),
	("gator", "ğŸŠ"),
	("alligator", "ğŸŠ"),
	("tiger", "ğŸ…"),
	("eleph", "ğŸ˜"),
	("hippo", "ğŸ¦›"),
	("cow", "ğŸ„"),
	("beef", "ğŸ„"),
	("pork", "ğŸ–"),
	("hog", "ğŸ–"),
	("ram", "ğŸ"),
	("sheep", "ğŸ‘"),
	("lamb", "ğŸ‘"),
	("cock", "ğŸ“"),
	("turkey", "ğŸ¦ƒ"),
	("bird", "ğŸ¦œ"),
	("swan", "ğŸ¦¢"),
	("rabbit", "ğŸ‡"),
	("bunny", "ğŸ‡"),
	("rat", "ğŸ€"),
	("dragon", "ğŸ‰"),
	("tree", "ğŸŒ²"),
	("herb", "ğŸŒ¿"),
	("leaf", "ğŸ"),
	("mushroom", "ğŸ„"),
	("shroom", "ğŸ„"),
	("shell", "ğŸš"),
	("flower", "ğŸŒ·"),
	("rose", "ğŸŒ¹"),
	("wilt", "ğŸ¥€"),
	("sun", "ğŸŒ"),
	("moon", "ğŸŒš"),
	("star", "â­ï¸"),
	("bolt", "âš¡ï¸"),
	("fire", "ğŸ”¥ğŸ”¥"),
	("cloud", "â˜ï¸"),
	("snowflake", "â„ï¸"),
	("flake", "â„ï¸"),
	("fruit", "ğŸğŸ"),
	("apple", "ğŸ"),
	("orange", "ğŸŠ"),
	("lemon", "ğŸ‹"),
	("grape", "ğŸ‡"),
	("melon", "ğŸˆ"),
	("cherr", "ğŸ’"),
	("peach", "ğŸ‘"),
	("ass", "ğŸ‘"),
	("thicc", "ğŸ‘"),
	("coconut", "ğŸ¥¥"),
	("kiwi", "ğŸ¥"),
	("tomato", "ğŸ…"),
	("eggplant", "ğŸ†"),
	("dick", "ğŸ†"),
	("avocado", "ğŸ¥‘"),
	("millenial", "ğŸ¥‘"),
	("chili", "ğŸŒ¶"),
	("pepper", "ğŸŒ¶"),
	("spicy", "ğŸŒ¶"),
	("corn", "ğŸŒ½"),
	("world", "ğŸŒ"),
	("potato", "ğŸ¥”"),
	("bagel", "ğŸ¥¯"),
	("bread", "ğŸ"),
	("cheese", "ğŸ§€"),
	("egg", "ğŸ¥š"),
	("pancake", "ğŸ¥"),
	("bacon", "ğŸ¥“"),
	("steak", "ğŸ¥©"),
	("meat", "ğŸ–"),
	("bone", "ğŸ¦´"),
	("hamburger", "ğŸ”"),
	("burger", "ğŸ”"),
	("pizza", "ğŸ•"),
	("taco", "ğŸŒ®"),
	("burrito", "ğŸŒ¯"),
	("salad", "ğŸ¥—"),
	("spaghetti", "ğŸ"),
	("ramen", "ğŸœ"),
	("noodles", "ğŸœ"),
	("curry", "ğŸ›"),
	("sushi", "ğŸ£"),
	("shrimp", "ğŸ¤"),
	("rice", "ğŸš"),
	("cake", "ğŸ°"),
	("candy", "ğŸ¬"),
	("choco", "ğŸ«"),
	("popcorn", "ğŸ¿"),
	("doughnut", "ğŸ©"),
	("donut", "ğŸ©"),
	("cookie", "ğŸª"),
	("peanut", "ğŸ¥œ"),
	("nuts", "ğŸ¥œ"),
	("honey", "ğŸ¯"),
	("milk", "ğŸ¥›"),
	("bottle", "ğŸ¼"),
	("coffee", "â˜•ï¸"),
	("tea", "ğŸµ"),
	("beer", "ğŸ»"),
	("pint", "ğŸº"),
	("wine", "ğŸ·"),
	("drink", "ğŸ¥ƒ"),
	("party", "ğŸ¾"),
	("salt", "ğŸ§‚"),
	("sport", "âš½ï¸ğŸ€"),

	("car", "ğŸš—"),
	("taxi", "ğŸš•"),
	("bus", "ğŸšŒ"),
	("polic", "ğŸš“"),
	("ambulance", "ğŸš‘"),
	("truck", "ğŸšš"),
	("scoot", "ğŸ›´"),
	("bike", "ğŸš²"),
	("scooter", "ğŸ›µ"),
	("moto", "ğŸ"),
	("bullet", "ğŸš…"),
	("train", "ğŸš‚"),
	("plane", "âœˆï¸"),
	("helicop", "ğŸš"),
	("boat", "ğŸ›¥"),
	("ship", "ğŸš¢"),
	("anchor", "âš“ï¸"),
	("liberty", "ğŸ—½"),
	("tower", "ğŸ—¼"),
	("castle", "ğŸ°"),
	("rollercoaster", "ğŸ¢"),
	("fount", "â›²ï¸"),
	("umbrella", "â›±"),
	("beach", "ğŸ–"),
	("island", "ğŸ"),
	("desert", "ğŸœ"),
	("volcano", "ğŸŒ‹"),
	("eruption", "ğŸŒ‹"),
	("mount", "â›°"),
	("camp", "ğŸ•"),
	("tent", "â›ºï¸"),
	("house", "ğŸ "),
	("home", "ğŸ¡"),
	("neighborhood", "ğŸ˜"),
	("crane", "ğŸ—"),
	("factory", "ğŸ­"),
	("industry", "ğŸ­"),
	("hospital", "ğŸ¥"),
	("hotel", "ğŸ¥"),
	("bank", "ğŸ¦"),
	("wave", "ğŸŒŠ"),
	("church", "â›ªï¸"),
	("mosque", "ğŸ•Œ"),
	("temple", "ğŸ•"),
	("god", "ğŸ•‹"),
	("tracks", "ğŸ›¤"),
	("road", "ğŸ›£"),

	("watch", "âŒšï¸"),
	("phone", "ğŸ“±"),
	("laptop", "ğŸ’»"),
	("computer", "ğŸ–¥"),
	("disk", "ğŸ’¿"),
	("tape", "ğŸ“¼"),
	("cam", "ğŸ“·"),
	("film", "ğŸ"),
	("telev", "ğŸ“º"),
	("mic", "ğŸ™"),
	("battery", "ğŸ”‹"),
	("plug", "ğŸ”Œ"),
	("lightbulb", "ğŸ’¡"),
	("bulb", "ğŸ’¡"),
	("idea", "ğŸ’¡"),
	("candle", "ğŸ•¯"),
	("barrel", "ğŸ›¢"),
	("oil", "ğŸ›¢"),
	("diamond", "ğŸ’"),
	("gem", "ğŸ’"),
	("scale", "âš–ï¸"),
	("justice", "âš–ï¸"),
	("toolbox", "ğŸ§°"),
	("wrench", "ğŸ”§"),
	("hammer", "ğŸ”¨"),
	("tools", "ğŸ› "),
	("pick", "â›"),
	("screw", "ğŸ”©"),
	("bolt", "ğŸ”©"),
	("nut", "ğŸ”©"),
	("gear", "âš™ï¸"),
	("brick", "ğŸ§±"),
	("chain", "â›“"),
	("magnet", "ğŸ§²"),
	("watergun", "ğŸ”«"),
	("gun", "ğŸ”«"),
	("shoot", "ğŸ”«"),
	("bomb", "ğŸ’£"),
	("dynamite", "ğŸ§¨"),
	("knife", "ğŸ”ªâš°ï¸"),
	("kill", "ğŸ”ªğŸ”ª"),
	("cigarette", "ğŸš¬"),
	("smoke", "ğŸš¬"),
	("coffin", "âš°ï¸"),
	("die", "âš°ï¸"),
]

const emojipasta = {line
	if etree == Zptr
		etree = radix.mk()
		for (k, v) : emap
			radix.put(etree, k, v)
		;;
	;;

	/* TODO: stop using strtok */
	var toks = std.strtok(line)
	var sb = std.mksb()
	for t : toks
		std.sbputs(sb, t)
		std.sbputc(sb, ' ')

		var t1 = lower(t)
		match radix.best(etree, t1)
		| `std.Some (_, v):
			if !std.sleq(v, "")
				var r = [1, 1, 1, 2, 2, 3][std.rand(0, 6)]
				for var i = 0; i < r; i++
					std.sbputs(sb, v)
				;;
				std.sbputc(sb, ' ')
			;;
		| `std.None:
		;;
		std.slfree(t1)
	;;
	-> std.strstrip(std.sbfin(sb))
}
